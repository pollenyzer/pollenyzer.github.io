(function(){var e={8905:function(e){var t=function(e){this.canvas=e.canvas,this.ctx=e.ctx,this.particleColor=e.options.particleColor,this.x=Math.random()*this.canvas.width,this.y=Math.random()*this.canvas.height,this.velocity={x:(Math.random()-.5)*e.options.velocity,y:(Math.random()-.5)*e.options.velocity}};t.prototype.update=function(){(this.x>this.canvas.width+20||this.x<-20)&&(this.velocity.x=-this.velocity.x),(this.y>this.canvas.height+20||this.y<-20)&&(this.velocity.y=-this.velocity.y),this.x+=this.velocity.x,this.y+=this.velocity.y},t.prototype.draw=function(){this.ctx.beginPath(),this.ctx.fillStyle=this.particleColor,this.ctx.globalAlpha=.7,this.ctx.arc(this.x,this.y,1.5,0,2*Math.PI),this.ctx.fill()};var a=function(e,t){this.canvasDiv=e,this.canvasDiv.size={width:this.canvasDiv.offsetWidth,height:this.canvasDiv.offsetHeight},t=void 0!==t?t:{},this.options={particleColor:void 0!==t.particleColor?t.particleColor:"#fff",background:void 0!==t.background?t.background:"#1a252f",interactive:void 0===t.interactive||t.interactive,velocity:this.setVelocity(t.speed),density:this.setDensity(t.density)},this.init()};a.prototype.init=function(){if(this.bgDiv=document.createElement("div"),this.canvasDiv.appendChild(this.bgDiv),this.setStyles(this.bgDiv,{position:"absolute",top:0,left:0,bottom:0,right:0,"z-index":1}),/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(this.options.background)&&this.setStyles(this.bgDiv,{background:this.options.background}),!/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(this.options.particleColor))return console.error("Please specify a valid particleColor hexadecimal color"),!1;this.canvas=document.createElement("canvas"),this.canvasDiv.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d"),this.canvas.width=this.canvasDiv.size.width,this.canvas.height=this.canvasDiv.size.height,this.setStyles(this.canvasDiv,{position:"relative"}),this.setStyles(this.canvas,{"z-index":"20",position:"relative"}),window.addEventListener("resize",function(){if(this.canvasDiv.offsetWidth===this.canvasDiv.size.width&&this.canvasDiv.offsetHeight===this.canvasDiv.size.height)return!1;this.canvas.width=this.canvasDiv.size.width=this.canvasDiv.offsetWidth,this.canvas.height=this.canvasDiv.size.height=this.canvasDiv.offsetHeight,clearTimeout(this.resetTimer),this.resetTimer=setTimeout(function(){this.particles=[];for(var e=0;e<this.canvas.width*this.canvas.height/this.options.density;e++)this.particles.push(new t(this));this.options.interactive&&this.particles.push(this.mouseParticle),requestAnimationFrame(this.update.bind(this))}.bind(this),500)}.bind(this)),this.particles=[];for(var e=0;e<this.canvas.width*this.canvas.height/this.options.density;e++)this.particles.push(new t(this));this.options.interactive&&(this.mouseParticle=new t(this),this.mouseParticle.velocity={x:0,y:0},this.particles.push(this.mouseParticle),this.canvas.addEventListener("mousemove",function(e){this.mouseParticle.x=e.clientX-this.canvas.offsetLeft,this.mouseParticle.y=e.clientY-this.canvas.offsetTop}.bind(this)),this.canvas.addEventListener("mouseup",function(){this.mouseParticle.velocity={x:(Math.random()-.5)*this.options.velocity,y:(Math.random()-.5)*this.options.velocity},this.mouseParticle=new t(this),this.mouseParticle.velocity={x:0,y:0},this.particles.push(this.mouseParticle)}.bind(this))),requestAnimationFrame(this.update.bind(this))},a.prototype.update=function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.globalAlpha=1;for(var e=0;e<this.particles.length;e++){this.particles[e].update(),this.particles[e].draw();for(var t=this.particles.length-1;t>e;t--){var a=Math.sqrt(Math.pow(this.particles[e].x-this.particles[t].x,2)+Math.pow(this.particles[e].y-this.particles[t].y,2));a>120||(this.ctx.beginPath(),this.ctx.strokeStyle=this.options.particleColor,this.ctx.globalAlpha=(120-a)/120,this.ctx.lineWidth=2.8,this.ctx.moveTo(this.particles[e].x,this.particles[e].y),this.ctx.lineTo(this.particles[t].x,this.particles[t].y),this.ctx.stroke())}}0!==this.options.velocity&&requestAnimationFrame(this.update.bind(this))},a.prototype.setVelocity=function(e){return"fast"===e?3.5:"slow"===e?1:"none"===e?0:.66},a.prototype.setDensity=function(e){return"high"===e?5e3:"low"===e?2e4:isNaN(parseInt(e,10))?1e4:e},a.prototype.setStyles=function(e,t){for(var a in t)e.style[a]=t[a]},e.exports={ParticleNetwork:a}},1522:function(e,t,a){"use strict";var i=a(9242),l=a(3396);function s(e,t,a,i,s,n){const o=(0,l.up)("router-view");return(0,l.wg)(),(0,l.j4)(o)}var n={name:"App",components:{}},o=a(89);const r=(0,o.Z)(n,[["render",s]]);var d=r,c=a(5431);(0,c.z)("/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}});var u=a(2483),h=a.p+"img/pollenyzer_logo.8c6997e9.svg";const p=(0,l._)("img",{class:"mx-auto my-4",style:{"max-width":"500px"},alt:"Vue logo",src:h},null,-1),m={key:0},f={key:0},v={key:0};function b(e,t,a,s,n,o){const r=(0,l.up)("MDBRow"),d=(0,l.up)("MDBCol"),c=(0,l.up)("MyCard1"),u=(0,l.up)("MyCard2"),h=(0,l.up)("MyCard3"),b=(0,l.up)("MDBContainer"),y=(0,l.up)("MyFooter");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l.Wm)(b,null,{default:(0,l.w5)((()=>[(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l.Wm)(d,{md:"12",class:"mx-auto"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[p])),_:1}),(0,l.Wm)(r)])),_:1})])),_:1}),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l.Wm)(i.uT,{appear:"",name:"bounce"},{default:(0,l.w5)((()=>[n.showCards[0]?((0,l.wg)(),(0,l.iD)("p",m,[(0,l.Wm)(c)])):(0,l.kq)("",!0)])),_:1}),(0,l.Wm)(i.uT,{name:"bounce"},{default:(0,l.w5)((()=>[n.showCards[1]?((0,l.wg)(),(0,l.iD)("p",f,[(0,l.Wm)(u,{ref:"metadata"},null,512)])):(0,l.kq)("",!0)])),_:1}),(0,l.Wm)(i.uT,{name:"bounce"},{default:(0,l.w5)((()=>[n.showCards[2]?((0,l.wg)(),(0,l.iD)("p",v,[(0,l.Wm)(h,{metaData:n.metaData},null,8,["metaData"])])):(0,l.kq)("",!0)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(y,{onNextCard:t[0]||(t[0]=e=>o.nextCard()),onPreviousCard:t[1]||(t[1]=e=>o.previousCard()),prevDisabled:n.prevDisabled,nextDisabled:n.nextDisabled},null,8,["prevDisabled","nextDisabled"])])}const y=e=>((0,l.dD)("data-v-941d3c70"),e=e(),(0,l.Cn)(),e),D={style:{color:"white",position:"fixed",bottom:"0",width:"100%"},class:"d-block d-md-none"},g={class:"text-center p-1",style:{"background-image":"linear-gradient(to top,rgba(151, 190, 17, 1),rgba(151, 190, 17, 0.3),rgba(251,252,235, 0))"}},_={key:0,class:"text-center bgcol_green",style:{width:"100%","min-height":"1em"}},w=(0,l.Uk)(" © 2023 Pollenyzer "),x=y((()=>(0,l._)("span",{style:{color:"rgba(255, 255, 255, 0.3)"}},"v0.2",-1))),C=[w,x],k={style:{width:"100%","padding-bottom":"100px"},class:"d-none d-md-block text-center"},M=y((()=>(0,l._)("div",{style:{height:"50px"}},null,-1))),B={style:{color:"white",position:"fixed",bottom:"0",width:"100%"}},W={key:0,class:"text-center bgcol_dark text-smaller",style:{width:"100%","min-height":"1em"}},$=(0,l.Uk)(" © 2022 Pollenyzer "),T=y((()=>(0,l._)("span",{style:{color:"rgba(255, 255, 255, 0.4)"}},"v0.2",-1))),z=[$,T];function R(e,t,a,i,s,n){const o=(0,l.up)("MyCardControls");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",D,[(0,l._)("div",g,[(0,l.Wm)(o,{onNextCard:t[0]||(t[0]=t=>e.$emit("nextCard")),onPreviousCard:t[1]||(t[1]=t=>e.$emit("previousCard")),nextDisabled:a.nextDisabled,prevDisabled:a.prevDisabled},null,8,["nextDisabled","prevDisabled"])]),((0,l.wg)(),(0,l.iD)("div",_,C))]),(0,l._)("div",k,[(0,l.Wm)(o,{onNextCard:t[2]||(t[2]=t=>e.$emit("nextCard")),onPreviousCard:t[3]||(t[3]=t=>e.$emit("previousCard")),nextDisabled:a.nextDisabled,prevDisabled:a.prevDisabled},null,8,["nextDisabled","prevDisabled"]),M,(0,l._)("div",B,[((0,l.wg)(),(0,l.iD)("div",W,z))])])],64)}const I={class:"d-block d-md-none"},P={class:"mx-2"},U={class:"mx-2"},A={class:"d-none d-md-block"},S={class:"m-5"},O={class:"m-5"};function j(e,t,a,i,s,n){const o=(0,l.up)("MDBIcon"),r=(0,l.up)("MDBBtn");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l._)("div",I,[(0,l._)("span",P,[(0,l.Wm)(r,{onClick:t[0]||(t[0]=t=>e.$emit("previousCard")),class:"mx-auto btn-dark mx-2",floating:"",disabled:a.prevDisabled},{default:(0,l.w5)((()=>[(0,l.Wm)(o,{icon:"angle-left"})])),_:1},8,["disabled"])]),(0,l._)("span",U,[(0,l.Wm)(r,{onClick:t[1]||(t[1]=t=>e.$emit("nextCard")),class:"mx-auto btn-dark mx-2",floating:"",disabled:a.nextDisabled},{default:(0,l.w5)((()=>[(0,l.Wm)(o,{icon:"angle-right"})])),_:1},8,["disabled"])])]),(0,l._)("div",A,[(0,l._)("span",S,[(0,l.Wm)(r,{onClick:t[2]||(t[2]=t=>e.$emit("previousCard")),class:"mx-auto btn-dark mx-2",floating:"",disabled:a.prevDisabled},{default:(0,l.w5)((()=>[(0,l.Wm)(o,{icon:"angle-left"})])),_:1},8,["disabled"])]),(0,l._)("span",O,[(0,l.Wm)(r,{onClick:t[3]||(t[3]=t=>e.$emit("nextCard")),class:"mx-auto btn-dark mx-2",floating:"",disabled:a.nextDisabled},{default:(0,l.w5)((()=>[(0,l.Wm)(o,{icon:"angle-right"})])),_:1},8,["disabled"])])])])}var H=a(6818),V={data(){return{}},props:{prevDisabled:Boolean,nextDisabled:Boolean},name:"CamControls",components:{MDBBtn:H.MDBBtn,MDBIcon:H.MDBIcon}};const F=(0,o.Z)(V,[["render",j]]);var E=F,N={components:{MyCardControls:E},props:{prevDisabled:Boolean,nextDisabled:Boolean},emits:["nextCard","previousCard"]};const q=(0,o.Z)(N,[["render",R],["__scopeId","data-v-941d3c70"]]);var L=q,Z=a.p+"img/pollenyzer-example.890cdf71.jpg";const G=(0,l.Uk)("Analyze the content of your pollen traps!"),Y=(0,l._)("ol",null,[(0,l._)("li",null,"Attach the pollen trap to the hive for a few days."),(0,l._)("li",null,"Harvest the pollen."),(0,l._)("li",null,"Photograph your catch."),(0,l._)("li",null,"(Opt. provide some additional information for scientists)."),(0,l._)("li",null,"Analyze your pollen!")],-1),J=(0,l.Uk)(" If you need help with scientific (digital) pollen analysis, please contact pollenyzer {at} trio.li, "),K=(0,l._)("div",{class:"row justify-content-evenly"},[(0,l._)("img",{src:Z,style:{width:"unset","max-height":"350px"}})],-1);function X(e,t,a,i,s,n){const o=(0,l.up)("MDBCardTitle"),r=(0,l.up)("MDBCardText"),d=(0,l.up)("MDBCardBody"),c=(0,l.up)("MDBCard");return(0,l.wg)(),(0,l.j4)(c,null,{default:(0,l.w5)((()=>[(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l.Wm)(o,null,{default:(0,l.w5)((()=>[G])),_:1}),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[Y,J])),_:1}),K])),_:1})])),_:1})}var Q={name:"MyCard1",components:{MDBCard:H.MDBCard,MDBCardBody:H.MDBCardBody,MDBCardTitle:H.MDBCardTitle,MDBCardText:H.MDBCardText}};const ee=(0,o.Z)(Q,[["render",X]]);var te=ee,ae=a(7139);const ie=(0,l.Uk)("Support science!"),le=(0,l.Uk)(" You can skip this, but if you want to save the bees, please give us additional information about your hive. "),se=(0,l._)("hr",null,null,-1),ne=(0,l._)("label",{for:"coords",class:"form-label"},"Hive's location",-1),oe=(0,l.Uk)(" Find the location of your bees on Google maps, right-click on the position and copy the coordinates into this field. "),re=(0,l._)("span",{class:"input-group-text border-0",id:"search-addon"},[(0,l._)("i",{class:"fas fa-map-marker-alt"})],-1),de=(0,l._)("hr",null,null,-1),ce=(0,l._)("label",{for:"habitat",class:"form-label"},"Hive's habitat type",-1),ue=(0,l.Uk)(" Select which type of habitat best describes the hive's surroundings within a 2km radius. "),he={class:"form-check"},pe=(0,l._)("label",{class:"form-check-label",for:"flexRadioDefault1"},"unknown",-1),me={class:"form-check"},fe=(0,l._)("label",{class:"form-check-label",for:"flexRadioDefault2"},"Arable land",-1),ve={class:"form-check"},be=(0,l._)("label",{class:"form-check-label",for:"flexRadioDefault3"},"urban",-1),ye={class:"form-check"},De=(0,l._)("label",{class:"form-check-label",for:"flexRadioDefault4"},"village",-1),ge={class:"form-check"},_e=(0,l._)("label",{class:"form-check-label",for:"flexRadioDefault5"},"pasture/meadow",-1),we={class:"form-check"},xe=(0,l._)("label",{class:"form-check-label",for:"flexRadioDefault6"},"heath/moor",-1),Ce={class:"form-check"},ke=(0,l._)("label",{class:"form-check-label",for:"flexRadioDefault7"},"salt marsh",-1),Me={class:"form-check"},Be=(0,l._)("label",{class:"form-check-label",for:"flexRadioDefault8"},"deciduous forest",-1),We={class:"form-check"},$e=(0,l._)("label",{class:"form-check-label",for:"flexRadioDefault9"},"coniferous forest",-1),Te={class:"form-check"},ze=(0,l._)("label",{class:"form-check-label",for:"flexRadioDefault10"},"mixed forest",-1),Re={class:"form-check"},Ie=(0,l._)("label",{class:"form-check-label",for:"flexRadioDefault11"},"wetland forest",-1),Pe=(0,l._)("hr",null,null,-1),Ue={for:"duration",class:"form-label"},Ae=(0,l.Uk)("No. of days the trap was mounted: "),Se=(0,l._)("hr",null,null,-1),Oe={for:"datepicker",class:"form-label"},je={style:{"text-align":"center",width:"100%"}},He=(0,l._)("hr",null,null,-1),Ve=(0,l._)("label",{for:"privacy",class:"form-label"},[(0,l._)("b",null,"* Data protection and usage (required)")],-1),Fe=(0,l._)("div",{style:{"text-align":"left",width:"100%",color:"rgb(234, 0, 0)"}},[(0,l.Uk)(' By clicking "Continue," you agree that a '),(0,l._)("a",{href:"https://policies.google.com/privacy?hl=en-US",target:"_blank"},"Google"),(0,l.Uk)(" Cloud Function on a U.S. server may "),(0,l._)("a",{href:"https://firebase.google.com/support/privacy",target:"_blank"},"temporarily"),(0,l.Uk)(" process your IP address and that the information you provide, including imagery, may be used for research purposes. Please do not provide any personal information. ")],-1),Ee=(0,l._)("label",{for:"checkbox",style:{"margin-left":"10px"}}," I Agree",-1);function Ne(e,t,a,s,n,o){const r=(0,l.up)("MDBCardTitle"),d=(0,l.up)("MDBCardText"),c=(0,l.up)("MDBInput"),u=(0,l.up)("vue3-slider"),h=(0,l.up)("Datepicker"),p=(0,l.up)("MDBCardBody"),m=(0,l.up)("MDBCard");return(0,l.wg)(),(0,l.j4)(m,null,{default:(0,l.w5)((()=>[(0,l.Wm)(p,{class:"xtra-padding"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[ie])),_:1}),(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[le])),_:1}),se,ne,(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[oe])),_:1}),(0,l.Wm)(c,{id:"coords",inputGroup:"",formOutline:!1,wrapperClass:"mb-3",class:"rounded",modelValue:n.hiveCoords,"onUpdate:modelValue":t[0]||(t[0]=e=>n.hiveCoords=e),"aria-describedby":"Apiary's coordinates.","aria-label":"Apiary's coordinates",placeholder:"Apiary's coordinates"},{prepend:(0,l.w5)((()=>[re])),_:1},8,["modelValue"]),de,ce,(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[ue])),_:1}),(0,l._)("div",he,[(0,l.wy)((0,l._)("input",{class:"form-check-input","onUpdate:modelValue":t[1]||(t[1]=e=>n.habitat=e),type:"radio",name:"flexRadioDefault",value:"unknown",id:"flexRadioDefault1"},null,512),[[i.G2,n.habitat]]),pe]),(0,l._)("div",me,[(0,l.wy)((0,l._)("input",{class:"form-check-input","onUpdate:modelValue":t[2]||(t[2]=e=>n.habitat=e),type:"radio",name:"flexRadioDefault",value:"arable land",id:"flexRadioDefault2"},null,512),[[i.G2,n.habitat]]),fe]),(0,l._)("div",ve,[(0,l.wy)((0,l._)("input",{class:"form-check-input","onUpdate:modelValue":t[3]||(t[3]=e=>n.habitat=e),type:"radio",name:"flexRadioDefault",value:"urban",id:"flexRadioDefault3"},null,512),[[i.G2,n.habitat]]),be]),(0,l._)("div",ye,[(0,l.wy)((0,l._)("input",{class:"form-check-input","onUpdate:modelValue":t[4]||(t[4]=e=>n.habitat=e),type:"radio",name:"flexRadioDefault",value:"village",id:"flexRadioDefault4"},null,512),[[i.G2,n.habitat]]),De]),(0,l._)("div",ge,[(0,l.wy)((0,l._)("input",{class:"form-check-input","onUpdate:modelValue":t[5]||(t[5]=e=>n.habitat=e),type:"radio",name:"flexRadioDefault",value:"pasture/meadow",id:"flexRadioDefault5"},null,512),[[i.G2,n.habitat]]),_e]),(0,l._)("div",we,[(0,l.wy)((0,l._)("input",{class:"form-check-input","onUpdate:modelValue":t[6]||(t[6]=e=>n.habitat=e),type:"radio",name:"flexRadioDefault",value:"heath/moor",id:"flexRadioDefault6"},null,512),[[i.G2,n.habitat]]),xe]),(0,l._)("div",Ce,[(0,l.wy)((0,l._)("input",{class:"form-check-input","onUpdate:modelValue":t[7]||(t[7]=e=>n.habitat=e),type:"radio",name:"flexRadioDefault",value:"salt marsh",id:"flexRadioDefault7"},null,512),[[i.G2,n.habitat]]),ke]),(0,l._)("div",Me,[(0,l.wy)((0,l._)("input",{class:"form-check-input","onUpdate:modelValue":t[8]||(t[8]=e=>n.habitat=e),type:"radio",name:"flexRadioDefault",value:"deciduous forest",id:"flexRadioDefault8"},null,512),[[i.G2,n.habitat]]),Be]),(0,l._)("div",We,[(0,l.wy)((0,l._)("input",{class:"form-check-input","onUpdate:modelValue":t[9]||(t[9]=e=>n.habitat=e),type:"radio",name:"flexRadioDefault",value:"coniferous forest",id:"flexRadioDefault9"},null,512),[[i.G2,n.habitat]]),$e]),(0,l._)("div",Te,[(0,l.wy)((0,l._)("input",{class:"form-check-input","onUpdate:modelValue":t[10]||(t[10]=e=>n.habitat=e),type:"radio",name:"flexRadioDefault",value:"mixed forest",id:"flexRadioDefault10"},null,512),[[i.G2,n.habitat]]),ze]),(0,l._)("div",Re,[(0,l.wy)((0,l._)("input",{class:"form-check-input","onUpdate:modelValue":t[11]||(t[11]=e=>n.habitat=e),type:"radio",name:"flexRadioDefault",value:"wetland forest",id:"flexRadioDefault11"},null,512),[[i.G2,n.habitat]]),Ie]),Pe,(0,l._)("label",Ue,[Ae,(0,l._)("b",null,(0,ae.zw)(n.daysMounted),1)]),(0,l.Wm)(u,{id:"duration",trackColor:"#ffa820",color:"#97be11",modelValue:n.daysMounted,"onUpdate:modelValue":t[12]||(t[12]=e=>n.daysMounted=e),handleScale:2.1,min:1,alwaysShowHandle:!0,sticky:!0,max:7,disabled:!1},null,8,["modelValue","handleScale"]),Se,(0,l._)("label",Oe,"When was the pollen trap opened? "+(0,ae.zw)(n.trapOpenedDate),1),(0,l._)("div",je,[(0,l.Wm)(h,{id:"datepicker",selectText:"",timePicker:!1,"auto-apply":!0,inline:!0,modelValue:n.trapOpenedDate,"onUpdate:modelValue":t[13]||(t[13]=e=>n.trapOpenedDate=e)},null,8,["modelValue"])]),He,Ve,Fe,(0,l.wy)((0,l._)("input",{type:"checkbox",id:"checkbox","onUpdate:modelValue":t[14]||(t[14]=e=>n.privacyChecked=e)},null,512),[[i.e8,n.privacyChecked]]),Ee])),_:1})])),_:1})}var qe=a(8524),Le=a(1716),Ze=a.n(Le),Ge=a(4870),Ye={name:"MyCard2",data(){return{hiveCoords:void 0,trapOpenedDate:void 0,habitat:void 0,daysMounted:void 0,privacyChecked:!1}},components:{MDBCard:H.MDBCard,MDBCardBody:H.MDBCardBody,MDBCardTitle:H.MDBCardTitle,MDBCardText:H.MDBCardText,MDBInput:H.MDBInput,Datepicker:qe.Z,"vue3-slider":Ze()},setup(){const e=(0,Ge.iH)(""),t=(0,Ge.iH)(""),a=(0,Ge.iH)(""),i=(0,Ge.iH)(""),l=(0,Ge.iH)(""),s=(0,Ge.iH)("");return{input12:e,input13:t,input14:a,input15:i,input16:l,textarea2:s}}};const Je=(0,o.Z)(Ye,[["render",Ne]]);var Ke=Je,Xe=a.p+"img/how-to-pollenyzer.66e0ffbc.jpg";const Qe=e=>((0,l.dD)("data-v-d6f383d0"),e=e(),(0,l.Cn)(),e),et=(0,l.Uk)("Take or upload a photo!"),tt=Qe((()=>(0,l._)("ul",{class:"fa-ul p-1 py-3"},[(0,l._)("li",null,[(0,l._)("span",{class:"fa-li"},[(0,l._)("i",{class:"fas fa-check col_green"})]),(0,l._)("p",null," Place pollen on a white, folded piece of paper (A5). ")]),(0,l._)("li",null,[(0,l._)("span",{class:"fa-li"},[(0,l._)("i",{class:"fas fa-check col_green"})]),(0,l._)("p",null," Pollen that is occluded by other pollen cannot be detected. ")]),(0,l._)("li",null,[(0,l._)("span",{class:"fa-li"},[(0,l._)("i",{class:"fas fa-check col_green"})]),(0,l._)("p",null,"Avoid casting shadows.")]),(0,l._)("li",null,[(0,l._)("span",{class:"fa-li"},[(0,l._)("i",{class:"fas fa-check col_green"})]),(0,l._)("p",null,"Avoid flash and use indirect natural daylight instead.")]),(0,l._)("li",null,[(0,l._)("span",{class:"fa-li"},[(0,l._)("i",{class:"fas fa-check col_green"})]),(0,l._)("p",null,"Recommended: Use a color calibration strip for consistent results. Such a strip can be found on Kellogg's (TM) products and is typically used to evaluate print quality. Make sure it shows the exact same 24 color patches that you see on the image below. The cut strip is automatically detected and used in the calculations. ")])],-1))),at=Qe((()=>(0,l._)("div",{class:"row justify-content-evenly"},[(0,l._)("img",{src:Xe,alt:"How to pollenyzer",style:{width:"unset","max-height":"350px"}})],-1))),it={class:"row justify-content-evenly",style:{"margin-top":"30px"}},lt={class:"col-4 text-center"},st=Qe((()=>(0,l._)("i",{class:"fas fa-camera",style:{}},null,-1))),nt=[st],ot={class:"col-4 text-center"},rt={for:"file"},dt=Qe((()=>(0,l._)("i",{class:"fas fa-2x fa-file-upload",style:{cursor:"pointer"}},null,-1))),ct={type:"file",ref:"fileupload",id:"file",style:{display:"none"},name:"image",accept:"image/jpeg,image/jpg,image/png",multiple:"","data-original-title":"upload photos"},ut=Qe((()=>(0,l._)("div",{class:"row justify-content-evenly"},[(0,l._)("div",{class:"col-4 text-center small p-1"},"Open Camera"),(0,l._)("div",{class:"col-4 text-center small p-1"},"Upload File ")],-1)));function ht(e,t,a,i,s,n){const o=(0,l.up)("MDBCardTitle"),r=(0,l.up)("MDBCardText"),d=(0,l.up)("MDBCardBody"),c=(0,l.up)("MDBCard");return(0,l.wg)(),(0,l.j4)(c,null,{default:(0,l.w5)((()=>[(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l.Wm)(o,null,{default:(0,l.w5)((()=>[et])),_:1}),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[tt])),_:1}),at,(0,l._)("div",it,[(0,l._)("div",lt,[(0,l._)("a",{class:"btn btn-primary btn-lg btn-floating btn-dark",onClick:t[0]||(t[0]=e=>n.openCam()),role:"button"},nt)]),(0,l._)("div",ot,[(0,l._)("label",rt,[dt,(0,l._)("input",ct,null,512)])])]),ut])),_:1})])),_:1})}var pt={name:"MyCard3",data(){return{date:null}},components:{MDBCard:H.MDBCard,MDBCardBody:H.MDBCardBody,MDBCardTitle:H.MDBCardTitle,MDBCardText:H.MDBCardText},props:{metaData:void 0},mounted(){const e=this.$refs.fileupload;e.onclick=function(){this.value=null};const t=this.$router;var a=this;e.addEventListener("change",(function(){const e=new FileReader;e.addEventListener("load",(function(){const i=e.result;t.push({name:"main",params:{uploaded_image:i,metaData:JSON.stringify(a.metaData)}})})),e.readAsDataURL(this.files[0])}))},methods:{openCam(){this.$router.push({name:"main",params:{metaData:JSON.stringify(this.metaData)}})}}};const mt=(0,o.Z)(pt,[["render",ht],["__scopeId","data-v-d6f383d0"]]);var ft=mt,vt={data(){return{cardId:0,showCards:[!0,!1,!1],prevDisabled:!0,nextDisabled:!1,metaData:void 0}},methods:{nextCard(){if(this.showCards[this.cardId]=!1,this.cardId++,this.showCards[this.cardId]=!0,0===this.cardId)this.prevDisabled=!0,this.nextDisabled=!1;else if(2===this.cardId){if(this.metaData={hiveCoords:this.$refs.metadata.hiveCoords,trapOpenedDate:this.$refs.metadata.trapOpenedDate,habitat:this.$refs.metadata.habitat,daysMounted:this.$refs.metadata.daysMounted,privacyChecked:this.$refs.metadata.privacyChecked},!this.metaData.privacyChecked)return this.showCards[this.cardId]=!1,this.cardId--,void(this.showCards[this.cardId]=!0);this.prevDisabled=!1,this.nextDisabled=!0}else this.prevDisabled=!1,this.nextDisabled=!1},previousCard(){this.showCards[this.cardId]=!1,this.cardId--,this.showCards[this.cardId]=!0,0===this.cardId?(this.prevDisabled=!0,this.nextDisabled=!1):2===this.cardId?(this.prevDisabled=!1,this.nextDisabled=!0):(this.prevDisabled=!1,this.nextDisabled=!1)}},name:"HomeView",components:{MyFooter:L,MyCard1:te,MyCard2:Ke,MyCard3:ft,MDBCol:H.MDBCol,MDBRow:H.MDBRow,MDBContainer:H.MDBContainer}};const bt=(0,o.Z)(vt,[["render",b]]);var yt=bt;const Dt=e=>((0,l.dD)("data-v-6b7670e8"),e=e(),(0,l.Cn)(),e),gt={style:{height:"100%",width:"100%"}},_t={key:0,style:{overflow:"hidden"},ref:"errorcontainer",class:"error-container parent"},wt={class:"error-close"},xt=Dt((()=>(0,l._)("i",{class:"fa fa-times fa-2x"},null,-1))),Ct=[xt],kt={class:"error-content"},Mt={key:1,ref:"maincamcontainer",style:{height:"100%",display:"flex"}},Bt={key:2,ref:"mainfilecontainer",style:{height:"100%",display:"flex"}},Wt={ref:"maindatacontainer",style:{display:"none"}};function $t(e,t,a,i,s,n){const o=(0,l.up)("MainCam"),r=(0,l.up)("MainFile"),d=(0,l.up)("MainData");return(0,l.wg)(),(0,l.iD)("div",gt,[s.errorMsg?((0,l.wg)(),(0,l.iD)("div",_t,[(0,l._)("div",wt,[(0,l._)("a",{style:{color:"#fbfceb"},href:"#!",onClick:t[0]||(t[0]=e=>{e.preventDefault(),this.errorMsg=null}),role:"button"},Ct)]),(0,l._)("div",kt,(0,ae.zw)(s.errorMsg),1)],512)):(0,l.kq)("",!0),e.$route.params?.uploaded_image?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",Mt,[(0,l.Wm)(o,{onError:t[1]||(t[1]=e=>n.onError(e)),metaData:e.$route.params?.metaData,onPhotoAnalyzed:t[2]||(t[2]=e=>n.onPhotoAnalyzed(e))},null,8,["metaData"])],512)),e.$route.params?.uploaded_image?((0,l.wg)(),(0,l.iD)("div",Bt,[(0,l.Wm)(r,{onError:t[3]||(t[3]=e=>n.onError(e)),metaData:e.$route.params?.metaData,onPhotoAnalyzed:t[4]||(t[4]=e=>n.onPhotoAnalyzed(e))},null,8,["metaData"])],512)):(0,l.kq)("",!0),(0,l._)("div",Wt,[(0,l.Wm)(d,{onRedo:t[5]||(t[5]=e=>n.onRedo()),onError:t[6]||(t[6]=e=>n.onError(e)),pollenData:s.pollenData},null,8,["pollenData"])],512)])}const Tt=e=>((0,l.dD)("data-v-f2c65f34"),e=e(),(0,l.Cn)(),e),zt={class:"wrapper align-items-center justify-content-center",style:{display:"flex"}},Rt={ref:"videocanvas",class:"video-canvas"},It={ref:"particlediv",class:"particle-div"},Pt={class:"video",ref:"videoviewer"},Ut={class:"photo-button-container d-block text-center my-3"},At=["disabled"],St=Tt((()=>(0,l._)("i",{class:"fas fa-camera",style:{}},null,-1))),Ot=[St];function jt(e,t,a,i,s,n){return(0,l.wg)(),(0,l.iD)("div",zt,[(0,l._)("canvas",Rt,null,512),(0,l._)("div",It,null,512),(0,l._)("video",Pt,null,512),(0,l._)("div",Ut,[(0,l._)("button",{class:"button photo-button",disabled:s.camButtonDisabled,onClick:t[0]||(t[0]=(...e)=>n.TakePhoto&&n.TakePhoto(...e))},Ot,8,At)])])}a(1703);var Ht=a(8905),Vt={components:{},data(){return{mediaStream:null,data:null,camButtonDisabled:!1}},props:{metaData:void 0},methods:{async StartRecording(){await navigator.mediaDevices.enumerateDevices().catch((e=>{this.$emit("error","Could not retrieve cameras. ("+e+")")}));let e=this.$refs.videoviewer,t=this.$refs.videocanvas,a=this.$refs.particlediv;this.camButtonDisabled=!1,t.style.display="none",a.display="none",e.style.display="block",this.mediaStream=navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:2048},height:{ideal:1536}}}).catch((e=>{this.$emit("error","Could not start camera. ("+e+")")})).then((t=>(this.mediaStream=t,e.srcObject=this.mediaStream,e.play().catch((e=>{this.$emit("error","Could not start playing camera stream. ("+e+")")})))))},async TakePhoto(){let e=this.$refs.videoviewer,t=this.$refs.videocanvas,a=this.$refs.particlediv;this.camButtonDisabled=!0;const i=t.getContext("2d");i.canvas.width=e.videoWidth,i.canvas.height=e.videoHeight;let l=e.videoWidth,s=e.videoHeight;i.drawImage(e,0,0,l,s);let n=e.clientWidth,o=t.toDataURL(),r=s/l;e.style.display="none",t.style.display="block",t.style.width="100%",a.style.display="block",a.innerHTML="",a.style.width=n+"px",a.style.height=n*r+"px";var d={particleColor:"#ffa820",background:o,interactive:!0,speed:"fast",density:"high"};new Ht.ParticleNetwork(a,d);const c={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({img:o,metadata:this.metaData})},u=this.mediaStream?.getVideoTracks();u?.forEach((e=>{e.stop()})),fetch("https://us-east1-pollenyzer-98b13.cloudfunctions.net/analyze123",c).then((e=>{if(!e.ok)return e.text().then((e=>{throw new Error(e)}));let t=e.json();return a.innerHTML="",a.style.display="none",t})).then((e=>{if(!e){const e="Could contact AI-server.";throw console.log(e),new Error(e)}e["dataURL"]=o,e["imgWidth"]=l,e["imgHeight"]=s,this.$emit("photoAnalyzed",e)})).catch((e=>{console.log("server error",e),this.$emit("error","Could not retrieve pollen analysis. ("+e+")"),a.innerHTML="",a.style.display="none",this.$router.push({name:"main",params:{}})}))}},async mounted(){await this.StartRecording().catch((e=>{this.$emit("error","Could not start camera. ("+e+")")}))}};const Ft=(0,o.Z)(Vt,[["render",jt],["__scopeId","data-v-f2c65f34"]]);var Et=Ft;const Nt={ref:"datawrapper"},qt=(0,l._)("img",{class:"mx-auto my-4",style:{"max-width":"500px"},src:h},null,-1),Lt={key:0},Zt=(0,l.Uk)("Pollen Detections"),Gt={style:{"margin-bottom":"2em"}},Yt={key:0},Jt={key:1},Kt=(0,l._)("li",null," Use the zoom function to check on the highlighted detections. ",-1),Xt={id:"annotationimgcontainer",ref:"annotationimgcontainer"},Qt={ref:"annotationimg",id:"annotationimg",style:{display:"none"}},ea={style:{display:"none"},ref:"annotationcanvas",class:"annotation-canvas"},ta={key:0},aa={style:{"margin-bottom":"10px",width:"100%","text-align":"center","font-weight":"bold"}},ia=(0,l._)("div",{class:"cluster-img-wrapper"},[(0,l._)("div",{style:{"font-weight":"bold"}},"Diversity indices")],-1),la={class:"cluster-img-wrapper"},sa=(0,l._)("a",{href:"https://en.wikipedia.org/wiki/Diversity_index",target:"_blank"},"Richness",-1),na=(0,l._)("a",{href:"https://en.wikipedia.org/wiki/Diversity_index",target:"_blank"},"Shannon",-1),oa=(0,l._)("a",{href:"https://en.wikipedia.org/wiki/Diversity_index",target:"_blank"},"Evenness",-1),ra=(0,l._)("a",{href:"https://en.wikipedia.org/wiki/Diversity_index",target:"_blank"},"Avg. cluster size",-1),da=(0,l._)("div",{class:"cluster-img-wrapper"},[(0,l._)("div",{style:{"font-weight":"bold"}}," primary pollen colors per cluster ")],-1),ca={key:0},ua=(0,l._)("div",{style:{"text-align":"center","margin-bottom":"-50px",color:"#888"}}," outliers (n less than 1 percent) ",-1),ha=(0,l._)("hr",{class:"outliers"},null,-1),pa=[ua,ha],ma={style:{color:"#888"}},fa=["src"];function va(e,t,a,s,n,o){const r=(0,l.up)("MDBRow"),d=(0,l.up)("MDBCol"),c=(0,l.up)("MDBCardTitle"),u=(0,l.up)("MDBCardText"),h=(0,l.up)("MDBCardBody"),p=(0,l.up)("MDBCard"),m=(0,l.up)("vue3-slider"),f=(0,l.up)("MDBContainer"),v=(0,l.up)("CamFooter");return(0,l.wg)(),(0,l.iD)("div",Nt,[(0,l.Wm)(f,null,{default:(0,l.w5)((()=>[(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l.Wm)(d,{md:"12",class:"mx-auto"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[qt])),_:1})])),_:1})])),_:1}),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l.Wm)(i.uT,{appear:"",name:"bounce",onAfterEnter:t[0]||(t[0]=e=>o.showAnnotations(a.pollenData))},{default:(0,l.w5)((()=>[n.showCards[0]?((0,l.wg)(),(0,l.iD)("p",Lt,[(0,l.Wm)(p,null,{default:(0,l.w5)((()=>[(0,l.Wm)(h,null,{default:(0,l.w5)((()=>[(0,l.Wm)(c,null,{default:(0,l.w5)((()=>[Zt])),_:1}),(0,l.Wm)(u,null,{default:(0,l.w5)((()=>[(0,l._)("ul",Gt,[(0,l._)("li",null,(0,ae.zw)(a.pollenData?.pollen?.n_pollen)+" pollen detected.",1),a.pollenData?.pollen?.calibration?((0,l.wg)(),(0,l.iD)("li",Yt," Calibration strip found. The extracted and processed color strip is shown in the upper right corner of the image below. ")):(0,l.kq)("",!0),a.pollenData?.pollen?.calibration?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("li",Jt," No calibration strip found. Consider to buy a Kellogs(TM) corn flakes packaging which includes a 24 color calibration strip. Other products that are printed on similar paper which contain the very same calibration strip can also be used. ")),Kt]),(0,l._)("div",Xt,null,512),(0,l._)("img",Qt,null,512),(0,l._)("canvas",ea,null,512)])),_:1})])),_:1})])),_:1})])):(0,l.kq)("",!0)])),_:1}),(0,l.Wm)(i.uT,{appear:"",name:"bounce"},{default:(0,l.w5)((()=>[n.showCards[1]?((0,l.wg)(),(0,l.iD)("p",ta,[(0,l.Wm)(p,null,{default:(0,l.w5)((()=>[(0,l.Wm)(h,null,{default:(0,l.w5)((()=>[(0,l.Wm)(u,null,{default:(0,l.w5)((()=>[(0,l._)("div",aa," #cluster "+(0,ae.zw)(n.nCluster)+", including "+(0,ae.zw)(a.pollenData?.pollen?.clusters?.cluster_imgs[n.nCluster].cluster.filter((e=>e.cluster_size<Math.ceil(a.pollenData?.pollen?.n_pollen/100))).length)+" outlier(s) ",1),(0,l.Wm)(m,{trackColor:"#ffa820",color:"#97be11",tooltip:!0,modelValue:n.nCluster,"onUpdate:modelValue":t[1]||(t[1]=e=>n.nCluster=e),handleScale:3,min:1,alwaysShowHandle:!0,sticky:!0,max:n.maxCluster},null,8,["modelValue","max"]),(0,l._)("div",null,[ia,(0,l._)("div",la,[(0,l._)("div",null,[sa,(0,l.Uk)(": "+(0,ae.zw)(a.pollenData?.pollen?.clusters?.cluster_imgs[n.nCluster]?.diversity?.richness),1)]),(0,l._)("div",null,[na,(0,l.Uk)(": "+(0,ae.zw)(a.pollenData?.pollen?.clusters?.cluster_imgs[n.nCluster]?.diversity?.shannon?.toFixed(4)||"non-calculable")+", ",1)]),(0,l._)("div",null,[oa,(0,l.Uk)(": "+(0,ae.zw)(a.pollenData?.pollen?.clusters?.cluster_imgs[n.nCluster]?.diversity?.shannon_eveness?.toFixed(4)||"non-calculable")+", ",1)]),(0,l._)("div",null,[ra,(0,l.Uk)(": "+(0,ae.zw)(a.pollenData?.pollen?.clusters?.cluster_imgs[n.nCluster]?.diversity?.avg_population_size?.toFixed(2)),1)])]),da,((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.pollenData?.pollen?.clusters?.cluster_imgs[n.nCluster].cluster,((e,t)=>((0,l.wg)(),(0,l.iD)("div",{class:"cluster-img-wrapper",key:e},[t>1&&a.pollenData?.pollen?.clusters?.cluster_imgs[n.nCluster].cluster[t-1].cluster_size>Math.ceil(a.pollenData?.pollen?.n_pollen/100)&&e.cluster_size<=Math.ceil(a.pollenData?.pollen?.n_pollen/100)?((0,l.wg)(),(0,l.iD)("div",ca,pa)):(0,l.kq)("",!0),(0,l._)("div",ma," cluster "+(0,ae.zw)(t+1)+" (n="+(0,ae.zw)(e.cluster_size)+") ",1),(0,l._)("img",{src:e.cluster_primary_canvas,class:"cluster-img"},null,8,fa)])))),128))])])),_:1})])),_:1})])),_:1})])):(0,l.kq)("",!0)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(v,{onNextCard:t[2]||(t[2]=e=>o.nextCard()),onPreviousCard:t[3]||(t[3]=e=>o.previousCard()),onRedo:t[4]||(t[4]=t=>e.$emit("redo")),prevDisabled:n.prevDisabled,nextDisabled:n.nextDisabled,redoDisabled:!1},null,8,["prevDisabled","nextDisabled"])],512)}const ba={style:{color:"white",position:"fixed",bottom:"0",width:"100%"},class:"d-block d-md-none"},ya={class:"text-center p-1",style:{"background-image":"linear-gradient(to top,rgba(151, 190, 17, 1),rgba(151, 190, 17, 0.3),rgba(251,252,235, 0))"}},Da={key:0,class:"text-center bgcol_green",style:{width:"100%","min-height":"1em"}},ga={style:{width:"100%","padding-bottom":"100px"},class:"d-none d-md-block text-center"},_a={style:{color:"white",position:"fixed",bottom:"0",width:"100%"}},wa={key:0,class:"text-center bgcol_dark text-smaller",style:{width:"100%","min-height":"1em"}};function xa(e,t,a,i,s,n){const o=(0,l.up)("CamControls");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",ba,[(0,l._)("div",ya,[(0,l.Wm)(o,{onNextCard:t[0]||(t[0]=t=>e.$emit("nextCard")),onPreviousCard:t[1]||(t[1]=t=>e.$emit("previousCard")),nextDisabled:a.nextDisabled,prevDisabled:a.prevDisabled,onRedo:t[2]||(t[2]=t=>e.$emit("redo"))},null,8,["nextDisabled","prevDisabled"])]),((0,l.wg)(),(0,l.iD)("div",Da," © 2022 Pollenyzer "))]),(0,l._)("div",ga,[(0,l.Wm)(o,{onNextCard:t[3]||(t[3]=t=>e.$emit("nextCard")),onPreviousCard:t[4]||(t[4]=t=>e.$emit("previousCard")),onRedo:t[5]||(t[5]=t=>e.$emit("redo")),nextDisabled:a.nextDisabled,prevDisabled:a.prevDisabled,redoDisabled:a.redoDisabled},null,8,["nextDisabled","prevDisabled","redoDisabled"]),(0,l._)("div",_a,[((0,l.wg)(),(0,l.iD)("div",wa," © 2022 Pollenyzer "))])])],64)}const Ca={class:"d-block d-md-none"},ka={class:"mx-2"},Ma={class:"mx-2"},Ba={class:"mx-2"},Wa={class:"d-none d-md-block"},$a={class:"m-5"},Ta={class:"m-5"},za={class:"m-5"};function Ra(e,t,a,i,s,n){const o=(0,l.up)("MDBIcon"),r=(0,l.up)("MDBBtn");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l._)("div",Ca,[(0,l._)("span",ka,[(0,l.Wm)(r,{onClick:t[0]||(t[0]=t=>e.$emit("previousCard")),class:"mx-auto btn-dark mx-2",floating:"",disabled:a.prevDisabled},{default:(0,l.w5)((()=>[(0,l.Wm)(o,{icon:"angle-left"})])),_:1},8,["disabled"])]),(0,l._)("span",Ma,[(0,l.Wm)(r,{onClick:t[1]||(t[1]=t=>e.$emit("redo")),class:"mx-auto btn-dark mx-2",floating:"",disabled:a.redoDisabled},{default:(0,l.w5)((()=>[(0,l.Wm)(o,{icon:"redo"})])),_:1},8,["disabled"])]),(0,l._)("span",Ba,[(0,l.Wm)(r,{onClick:t[2]||(t[2]=t=>e.$emit("nextCard")),class:"mx-auto btn-dark mx-2",floating:"",disabled:a.nextDisabled},{default:(0,l.w5)((()=>[(0,l.Wm)(o,{icon:"angle-right"})])),_:1},8,["disabled"])])]),(0,l._)("div",Wa,[(0,l._)("span",$a,[(0,l.Wm)(r,{onClick:t[3]||(t[3]=t=>e.$emit("previousCard")),class:"mx-auto btn-dark mx-2",floating:"",disabled:a.prevDisabled},{default:(0,l.w5)((()=>[(0,l.Wm)(o,{icon:"angle-left"})])),_:1},8,["disabled"])]),(0,l._)("span",Ta,[(0,l.Wm)(r,{onClick:t[4]||(t[4]=t=>e.$emit("redo")),class:"mx-auto btn-dark mx-2",floating:"",disabled:a.redoDisabled},{default:(0,l.w5)((()=>[(0,l.Wm)(o,{icon:"redo"})])),_:1},8,["disabled"])]),(0,l._)("span",za,[(0,l.Wm)(r,{onClick:t[5]||(t[5]=t=>e.$emit("nextCard")),class:"mx-auto btn-dark mx-2",floating:"",disabled:a.nextDisabled},{default:(0,l.w5)((()=>[(0,l.Wm)(o,{icon:"angle-right"})])),_:1},8,["disabled"])])])])}var Ia={data(){return{}},props:{prevDisabled:Boolean,nextDisabled:Boolean,redoDisabled:Boolean},name:"CamControls",components:{MDBBtn:H.MDBBtn,MDBIcon:H.MDBIcon}};const Pa=(0,o.Z)(Ia,[["render",Ra]]);var Ua=Pa,Aa={name:"CamFooter",components:{CamControls:Ua},props:{prevDisabled:Boolean,nextDisabled:Boolean,redoDisabled:Boolean},emits:["nextCard","previousCard","redo"]};const Sa=(0,o.Z)(Aa,[["render",xa],["__scopeId","data-v-fd317084"]]);var Oa=Sa,ja=a(9096),Ha={components:{MDBCol:H.MDBCol,MDBRow:H.MDBRow,MDBContainer:H.MDBContainer,MDBCard:H.MDBCard,MDBCardBody:H.MDBCardBody,MDBCardTitle:H.MDBCardTitle,MDBCardText:H.MDBCardText,CamFooter:Oa,"vue3-slider":Ze()},props:{pollenData:Object},data(){return{showCards:[!0,!1,!1],cardId:0,nCluster:1,maxCluster:1,prevDisabled:!0,nextDisabled:!1}},mounted(){},watch:{pollenData(e,t){this.showAnnotations(e)}},methods:{showAnnotations(e){if(e){this.nCluster=this.pollenData.pollen.clusters.n_clusters_predicted+this.pollenData.pollen.clusters.n_outliers_predicted,this.maxCluster=Object.keys(this.pollenData?.pollen?.clusters?.cluster_imgs).length||1,console.log("Maxclsuter",this.maxCluster,this.pollenData?.pollen?.clusters,this.pollenData?.pollen?.clusters.cluster_imgs,this.pollenData?.pollen?.clusters.length);let a=this.$refs.annotationcanvas,i=this.$refs.annotationimg;const l=a.getContext("2d");l.canvas.width=e.pollen.img_width,l.canvas.height=e.pollen.img_height;var t=new Image;t.onload=function(){l.drawImage(t,0,0,e.pollen.img_width,e.pollen.img_height),i.src=a.toDataURL(),new ja.Z("#annotationimgcontainer",{src:i,maxRatio:10,slider:!1,zoomer:!0})},t.src=e.pollen.annotated_img}},nextCard(){this.showCards[this.cardId]=!1,this.cardId++,this.showCards[this.cardId]=!0,0===this.cardId?(this.prevDisabled=!0,this.nextDisabled=!1):1===this.cardId?(this.prevDisabled=!1,this.nextDisabled=!0):(this.prevDisabled=!1,this.nextDisabled=!1)},previousCard(){this.showCards[this.cardId]=!1,this.cardId--,this.showCards[this.cardId]=!0,0===this.cardId?(this.prevDisabled=!0,this.nextDisabled=!1):1===this.cardId?(this.prevDisabled=!1,this.nextDisabled=!0):(this.prevDisabled=!1,this.nextDisabled=!1)}}};const Va=(0,o.Z)(Ha,[["render",va]]);var Fa=Va;const Ea=e=>((0,l.dD)("data-v-1f9ef85c"),e=e(),(0,l.Cn)(),e),Na={class:"wrapper align-items-center justify-content-center",style:{display:"flex"}},qa={ref:"particledivfile",class:"particle-div"},La=["src"],Za={class:"photo-button-container d-block text-center my-3"},Ga=["disabled"],Ya=Ea((()=>(0,l._)("i",{class:"fas fa-play",style:{}},null,-1))),Ja=[Ya];function Ka(e,t,a,i,s,n){return(0,l.wg)(),(0,l.iD)("div",Na,[(0,l._)("div",qa,null,512),(0,l._)("img",{class:"image",ref:"imgviewer",src:this.$route.params.uploaded_image},null,8,La),(0,l._)("div",Za,[(0,l._)("button",{class:"button photo-button",disabled:s.camButtonDisabled,onClick:t[0]||(t[0]=(...e)=>n.analyzeUpload&&n.analyzeUpload(...e))},Ja,8,Ga)])])}var Xa={components:{},data(){return{data:null,camButtonDisabled:!1}},props:{metaData:void 0},methods:{async analyzeUpload(){let e=this.$refs.imgviewer,t=e.width,a=e.height,i=this.$refs.particledivfile,l=this.$route.params.uploaded_image;this.camButtonDisabled=!0,i.style.display="block",i.innerHTML="",i.style.width="100%";let s=a/t;i.style.display="block",i.innerHTML="",i.style.width=e.clientWidth+"px",i.style.height=e.clientWidth*s+"px";var n={particleColor:"#ffa820",background:l,interactive:!0,speed:"fast",density:"high"};new Ht.ParticleNetwork(i,n);const o={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({img:l,metadata:this.metaData})};fetch("https://us-east1-pollenyzer-98b13.cloudfunctions.net/analyze123",o).then((e=>{if(!e.ok)return e.text().then((e=>{throw new Error(e)}));let t=e.json();return i.innerHTML="",i.style.display="none",t})).then((e=>{if(!e){const e="Could contact AI-server.";throw console.log(e),new Error(e)}console.log(e),e["dataURL"]=l,e["imgWidth"]=t,e["imgHeight"]=a,this.camButtonDisabled=!1,this.$emit("photoAnalyzed",e)})).catch((e=>{this.$emit("error","Could not retrieve pollen analysis. ("+e+")"),i.innerHTML="",i.style.display="none",router.push({name:"main",params:{uploaded_image:uploaded_image}})}))}},async mounted(){}};const Qa=(0,o.Z)(Xa,[["render",Ka],["__scopeId","data-v-1f9ef85c"]]);var ei=Qa,ti={components:{MainCam:Et,MainData:Fa,MainFile:ei},props:{},created(){},mounted(){},setup(){},data(){return{metaData:void 0,pollenData:void 0,errorMsg:null,errorZIndex:10}},methods:{onRedo(){this.$router.push("/")},onError(e){this.errorMsg=e,setTimeout((()=>{this.$refs.errorcontainer.style.zIndex=++this.errorZIndex}),200)},onPhotoAnalyzed(e){try{this.$refs.maincamcontainer.style.display="none"}catch{}try{this.$refs.mainfilecontainer.style.display="none"}catch{}this.$refs.maindatacontainer.style.display="block",this.pollenData=e}}};const ai=(0,o.Z)(ti,[["render",$t],["__scopeId","data-v-6b7670e8"]]);var ii=ai;const li=[{path:"/",name:"home",component:yt},{path:"/main",name:"main",component:ii},{path:"/:catchAll(.*)",component:yt}],si=(0,u.p7)({history:(0,u.r5)(),routes:li});var ni=si;(0,i.ri)(d).use(ni).mount("#app")}},t={};function a(i){var l=t[i];if(void 0!==l)return l.exports;var s=t[i]={exports:{}};return e[i].call(s.exports,s,s.exports,a),s.exports}a.m=e,function(){var e=[];a.O=function(t,i,l,s){if(!i){var n=1/0;for(c=0;c<e.length;c++){i=e[c][0],l=e[c][1],s=e[c][2];for(var o=!0,r=0;r<i.length;r++)(!1&s||n>=s)&&Object.keys(a.O).every((function(e){return a.O[e](i[r])}))?i.splice(r--,1):(o=!1,s<n&&(n=s));if(o){e.splice(c--,1);var d=l();void 0!==d&&(t=d)}}return t}s=s||0;for(var c=e.length;c>0&&e[c-1][2]>s;c--)e[c]=e[c-1];e[c]=[i,l,s]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var i in t)a.o(t,i)&&!a.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.p="/"}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,i){var l,s,n=i[0],o=i[1],r=i[2],d=0;if(n.some((function(t){return 0!==e[t]}))){for(l in o)a.o(o,l)&&(a.m[l]=o[l]);if(r)var c=r(a)}for(t&&t(i);d<n.length;d++)s=n[d],a.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return a.O(c)},i=self["webpackChunkpollenyzer"]=self["webpackChunkpollenyzer"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=a.O(void 0,[998],(function(){return a(1522)}));i=a.O(i)})();
//# sourceMappingURL=app.277bc3ee.js.map